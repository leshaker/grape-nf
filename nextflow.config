// main script name
manifest.mainScript = 'grape-pipeline.nf'

//Use Docker by default
docker {
    enabled = true
    //runOptions = "--oom-kill-disable=true"
}

// Process configuration
process {

    command = {
        cpus = task.cpus
        "${task.process}/${task.tool}${task.profile}"
    }

    profile = '' 

    errorStrategy = 'ignore'
    
    tag = { (id ? id.replace(':', '_') : species) + "-${task.tool}-${task.version}"}

    container = { "grape/${task.process.toLowerCase()}:${task.tool.toLowerCase()}-${task.version}" }

    $mapping {
     container = { "leshaker/starrsem:latest" }
 }

 $index {
     container = { "leshaker/starrsem:latest" }
 }

 $t_index {
     container = { "leshaker/starrsem:latest" }
 }

 $quantification {
     container = { "leshaker/starrsem:latest" }
 }

}

profiles {
    standard {
        // default profile - same as starrsem
        includeConfig "config/fastaIndex/SAMtools.config"
        includeConfig "config/mapping/STAR.config"
        includeConfig "config/mergeBam/SAMtools.config"
        includeConfig "config/inferExp/RSeQC.config"
        includeConfig "config/bigwig/STAR.config"
        includeConfig "config/contig/RGCRG.config"
        includeConfig "config/quantification/RSEM.config"
    }

    starrsem {
        // profile for STAR and RSEM
        includeConfig "config/fastaIndex/SAMtools.config"
        includeConfig "config/mapping/STAR.config"
        includeConfig "config/mergeBam/SAMtools.config"
        includeConfig "config/inferExp/RSeQC.config"
        includeConfig "config/bigwig/STAR.config"
        includeConfig "config/contig/RGCRG.config"
        includeConfig "config/quantification/RSEM.config"
    }

}
